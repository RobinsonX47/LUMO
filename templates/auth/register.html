{% extends "base.html" %} {% block title %}Sign Up – LUMO{% endblock %} {% block
content %}

<div
  style="
    min-height: calc(100vh - 100px);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
  "
>
  <div style="width: 100%; max-width: 420px">
    <div class="card-glass" style="padding: 48px; backdrop-filter: blur(10px)">
      <!-- Header -->
      <div style="margin-bottom: 40px">
        <h1
          style="
            margin: 0 0 12px 0;
            text-align: center;
            font-size: 2rem;
            font-weight: 700;
          "
        >
          Join LUMO
        </h1>
        <p
          style="
            text-align: center;
            color: var(--muted);
            margin: 0;
            font-size: 0.95rem;
          "
        >
          Create your account and start rating movies
        </p>
      </div>

      <!-- Flash Messages -->
      {% with messages = get_flashed_messages(with_categories=true) %} {% if
      messages %} {% for category, message in messages %}
      <div
        style="
            background: {{ 'rgba(34,197,94,0.15)' if category=='success' else 'rgba(239,68,68,0.15)' }};
            border: 1px solid {{ '#34d399' if category=='success' else 'rgba(239,68,68,0.4)' }};
            border-radius: 12px;
            padding: 14px 16px;
            margin-bottom: 24px;
            color: {{ '#86efac' if category=='success' else '#fca5a5' }};
            font-size: 0.9rem;
          "
      >
        {{ message }}
      </div>
      {% endfor %} {% endif %} {% endwith %}

      <!-- Email/Password Registration -->
      <form method="POST" action="{{ url_for('auth.register') }}">
        <div style="margin-bottom: 18px">
          <label
            style="
              display: block;
              margin-bottom: 8px;
              font-size: 0.85rem;
              color: var(--muted);
              font-weight: 500;
              text-transform: uppercase;
              letter-spacing: 0.5px;
            "
            >Full Name</label
          >
          <input
            type="text"
            name="name"
            required
            autocomplete="name"
            style="
              width: 100%;
              padding: 12px 16px;
              border-radius: 10px;
              border: 1px solid rgba(148, 163, 184, 0.3);
              background: rgba(15, 23, 42, 0.5);
              color: var(--text);
              font-size: 0.95rem;
              box-sizing: border-box;
              transition: all 0.2s ease;
            "
            placeholder="John Doe"
            onblur="this.style.borderColor = 'rgba(148, 163, 184, 0.3)'"
          />
        </div>

        <div style="margin-bottom: 18px">
          <label
            style="
              display: block;
              margin-bottom: 8px;
              font-size: 0.85rem;
              color: var(--muted);
              font-weight: 500;
              text-transform: uppercase;
              letter-spacing: 0.5px;
            "
            >Email Address</label
          >
          <input
            type="email"
            name="email"
            required
            autocomplete="email"
            style="
              width: 100%;
              padding: 12px 16px;
              border-radius: 10px;
              border: 1px solid rgba(148, 163, 184, 0.3);
              background: rgba(15, 23, 42, 0.5);
              color: var(--text);
              font-size: 0.95rem;
              box-sizing: border-box;
              transition: all 0.2s ease;
            "
            placeholder="you@example.com"
            onblur="this.style.borderColor = 'rgba(148, 163, 184, 0.3)'"
          />
        </div>

        <div style="margin-bottom: 18px">
          <label
            style="
              display: block;
              margin-bottom: 8px;
              font-size: 0.85rem;
              color: var(--muted);
              font-weight: 500;
              text-transform: uppercase;
              letter-spacing: 0.5px;
            "
            >Username</label
          >
          <input
            type="text"
            name="username"
            required
            pattern="[a-zA-Z0-9_-]{3,30}"
            autocomplete="username"
            placeholder="unique_username"
            id="username-input"
            style="
              width: 100%;
              padding: 12px 16px;
              border-radius: 10px;
              border: 1px solid rgba(148, 163, 184, 0.3);
              background: rgba(15, 23, 42, 0.5);
              color: var(--text);
              font-size: 0.95rem;
              box-sizing: border-box;
              transition: all 0.2s ease;
            "
            onblur="this.style.borderColor = 'rgba(148, 163, 184, 0.3)'"
          />
          <p
            style="
              margin: 6px 0 0 0;
              font-size: 0.8rem;
              color: rgba(148, 163, 184, 0.7);
            "
          >
            3-30 characters, letters, numbers, hyphens, underscores
          </p>
          <div id="username-status" style="margin-top: 8px; font-size: 0.8rem;"></div>
        </div>

        <div style="margin-bottom: 28px">
          <label
            style="
              display: block;
              margin-bottom: 8px;
              font-size: 0.85rem;
              color: var(--muted);
              font-weight: 500;
              text-transform: uppercase;
              letter-spacing: 0.5px;
            "
            >Password</label
          >
          <input
            type="password"
            name="password"
            required
            minlength="6"
            autocomplete="new-password"
            style="
              width: 100%;
              padding: 12px 16px;
              border-radius: 10px;
              border: 1px solid rgba(148, 163, 184, 0.3);
              background: rgba(15, 23, 42, 0.5);
              color: var(--text);
              font-size: 0.95rem;
              box-sizing: border-box;
              transition: all 0.2s ease;
            "
            placeholder="••••••••"
            onblur="this.style.borderColor = 'rgba(148, 163, 184, 0.3)'"
          />
          <p
            style="
              margin: 6px 0 0 0;
              font-size: 0.8rem;
              color: rgba(148, 163, 184, 0.7);
            "
          >
            At least 6 characters
          </p>
        </div>

        <div style="margin-bottom: 28px">
          <label
            style="
              display: block;
              margin-bottom: 8px;
              font-size: 0.85rem;
              color: var(--muted);
              font-weight: 500;
              text-transform: uppercase;
              letter-spacing: 0.5px;
            "
            >Confirm Password</label
          >
          <input
            type="password"
            name="confirm_password"
            required
            minlength="6"
            autocomplete="new-password"
            style="
              width: 100%;
              padding: 12px 16px;
              border-radius: 10px;
              border: 1px solid rgba(148, 163, 184, 0.3);
              background: rgba(15, 23, 42, 0.5);
              color: var(--text);
              font-size: 0.95rem;
              box-sizing: border-box;
              transition: all 0.2s ease;
            "
            placeholder="••••••••"
            onblur="this.style.borderColor = 'rgba(148, 163, 184, 0.3)'"
          />

        <button type="submit" class="btn-primary auth-submit-btn">Create Account</button>
      </form>

      <!-- Divider -->
      <div
        style="display: flex; align-items: center; margin: 32px 0; gap: 12px"
      >
        <div
          style="flex: 1; height: 1px; background: rgba(148, 163, 184, 0.2)"
        ></div>
        <span
          style="
            color: var(--muted);
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
          "
          >Or</span
        >
        <div
          style="flex: 1; height: 1px; background: rgba(148, 163, 184, 0.2)"
        ></div>
      </div>

      <!-- Google OAuth Button -->
      <a
        href="{{ url_for('auth.google_login') }}"
        style="
          display: flex;
          align-items: center;
          justify-content: center;
          width: 100%;
          padding: 13px 16px;
          border-radius: 10px;
          border: 1.5px solid rgba(148, 163, 184, 0.3);
          background: rgba(15, 23, 42, 0.5);
          color: var(--text);
          font-weight: 600;
          cursor: pointer;
          font-size: 0.95rem;
          transition: all 0.2s ease;
          text-decoration: none;
          box-sizing: border-box;
        "
        onmouseover="
          this.style.borderColor = 'rgba(123, 92, 255, 0.5)';
          this.style.backgroundColor = 'rgba(123, 92, 255, 0.1)';
        "
        onmouseout="
          this.style.borderColor = 'rgba(148, 163, 184, 0.3)';
          this.style.backgroundColor = 'rgba(15, 23, 42, 0.5)';
        "
      >
        <svg
          style="width: 18px; height: 18px; margin-right: 10px"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <path
            d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"
          />
          <path
            d="M12 12c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"
            fill="currentColor"
          />
        </svg>
        Sign up with Google
      </a>

      <!-- Sign In Link -->
      <p
        style="
          text-align: center;
          margin: 28px 0 0 0;
          color: var(--muted);
          font-size: 0.9rem;
        "
      >
        Already have an account?
        <a
          href="{{ url_for('auth.login') }}"
          style="
            color: var(--accent);
            text-decoration: none;
            font-weight: 600;
            transition: opacity 0.2s ease;
          "
          onmouseover="this.style.opacity = '0.8'"
          onmouseout="this.style.opacity = '1'"
          >Sign in</a
        >
      </p>
    </div>

    <!-- Footer Info -->
    <p
      style="
        text-align: center;
        color: var(--muted);
        font-size: 0.8rem;
        margin-top: 24px;
      "
    >
      By creating an account, you agree to our Terms of Service
    </p>
  </div>
</div>

<style>
  input:focus {
    outline: none;
    border-color: var(--accent) !important;
    background: rgba(123, 92, 255, 0.05) !important;
  }

  input::placeholder {
    color: rgba(148, 163, 184, 0.5);
  }

  /* Signup page button refinements (no hover bounce or heavy shadow) */
  .auth-submit-btn {
    width: 100%;
    padding: 16px 20px; /* more comfortable touch target */
    margin-top: 12px;  /* clear separation from input above */
    border-radius: 12px;
    background: linear-gradient(135deg, #7b5cff 0%, #a78bfa 100%);
    box-shadow: none;
  }

  .auth-submit-btn:hover {
    background: linear-gradient(135deg, #815fff 0%, #b19bfa 100%);
    transform: none;
    box-shadow: none;
  }
</style>

<script>
  // Username validation on register page
  const usernameInput = document.getElementById('username-input');
  const usernameStatus = document.getElementById('username-status');
  let checkTimeout;

  if (usernameInput) {
    usernameInput.addEventListener('input', function() {
      clearTimeout(checkTimeout);
      const username = this.value.trim().toLowerCase();

      if (!username) {
        usernameStatus.textContent = '';
        return;
      }

      if (!/^[a-zA-Z0-9_-]{3,30}$/.test(username)) {
        usernameStatus.innerHTML = '<span style="color: #fca5a5;">❌ Invalid format</span>';
        return;
      }

      usernameStatus.innerHTML = '<span style="color: #fbbf24;">⏳ Checking...</span>';

      checkTimeout = setTimeout(() => {
        fetch(`{{ url_for('users.check_username') }}?username=${encodeURIComponent(username)}`)
          .then(response => response.json())
          .then(data => {
            if (data.available) {
              usernameStatus.innerHTML = '<span style="color: #86efac;">✅ Available!</span>';
            } else {
              usernameStatus.innerHTML = '<span style="color: #fca5a5;">❌ Taken</span>';
            }
          });
      }, 500);
    });
  }
</script>

{% endblock %}
